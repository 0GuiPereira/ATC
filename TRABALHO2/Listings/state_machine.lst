C51 COMPILER V9.60.7.0   STATE_MACHINE                                                     01/07/2024 17:39:18 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE STATE_MACHINE
OBJECT MODULE PLACED IN .\Objects\state_machine.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE state_machine.c OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\state_machine.lst) TABS(2) OBJECT(.\Objects\state_machine.obj)

line level    source

   1          #include <REG51F380.H>
   2          #include <REG51F380.H>
   3          #include <stdio.h>
   4          #include "config_platform.h"
   5          #include "serialIO.h"
   6          #include "timer2_delay.h"
   7          
   8          sbit pb1 = P0^6;
   9          sbit pb2 = P0^7;
  10          
  11          char code *ptr;
  12          
  13          char code sentidoNorteSul[] = "Hello uart0 m0\r\n";
  14          char code sentidoEsteOeste[] = "testeEO\r\n";
  15          
  16          
  17          unsigned char digits_array[10] = {0xC0, 0xF9, 0xA4, 0xB0, 0x99, 0x92, 0x82, 0xF8, 0x80, 0x90};
  18          
  19          
  20          /*********************************************************/
  21          typedef enum ENUM_STATES {S1 = 0, S2} e_states;
  22          
  23          e_states state, nextstate;
  24          
  25          /* function prototypes */
  26          void state_1 (void);
  27          void state_2 (void);
  28          
  29          void temporizador(){
  30   1        char i;
  31   1        for (i = 9; i >= 0; --i) {
  32   2            P2 = digits_array[i];
  33   2            delay_s(1);
  34   2            nextstate = S2;
  35   2        }
  36   1        for(ptr = (char code*)sentidoNorteSul; *ptr!= '\0'; ptr++){
  37   2          while(uart0_putchar(*ptr)== -ENOBUFS);
  38   2        }
  39   1      }
  40          
  41          void NorteSul(){
  42   1      
  43   1        
  44   1      //print_u0(sentidoNorteSul);
  45   1        
  46   1        temporizador();
  47   1      }
  48          
  49          void EsteOeste(){
  50   1        temporizador();
  51   1        nextstate = S1;
  52   1      }
  53          /*********************************************************/ 
  54          
C51 COMPILER V9.60.7.0   STATE_MACHINE                                                     01/07/2024 17:39:18 PAGE 2   

  55          void (*state_process [])(void) = {state_1, state_2};
  56          
  57          
  58          void state_1(void){
  59   1        NorteSul();
  60   1      }
  61          void state_2(void){
  62   1        
  63   1      }
  64          
  65          /*********************************************************/
  66          void encode_FSM(){
  67   1          state_process[state] ();
  68   1      }
  69          
  70          /*********************************************************
  71           *    main function                                      *
  72           *********************************************************/
  73          void main (void){
  74   1        
  75   1        
  76   1        Init_Device();
  77   1        uart0_initialize();
  78   1        timer2_init_auto(-40000);
  79   1      
  80   1        //Set by hardware when the Timer 2 high byte overflows from 0xFF to 0x00. In 16 bit 
  81   1        //mode, this will occur when Timer 2 overflows from 0xFFFF to 0x0000.   
  82   1        TF2H = 0; 
  83   1        // Enable Flag Timer 2 Overflow
  84   1        // Timer 2 Run Control. Timer 2 is enabled by setting this bit to 1. 
  85   1        TR2 = 1;
  86   1        
  87   1        EA=1;
  88   1        
  89   1        state = nextstate = S1;
  90   1        
  91   1        while (1) {
  92   2          
  93   2          encode_FSM();
  94   2          state = nextstate;
  95   2          
  96   2        }
  97   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    157    ----
   CONSTANT SIZE    =     27    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     21    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
